{"remainingRequest":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/src/components/search/logView.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/src/components/search/logView.vue","mtime":1630482556916},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CgpleHBvcnQgZGVmYXVsdHsKICAgIHByb3BzOiB7CiAgICAgICAgbW9kZWw6IE9iamVjdAogICAgfSwKICAgIGRhdGEoKXsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBkcmFnZ2luZzogZmFsc2UsCiAgICAgICAgICAgIGVkaXRvcjogewogICAgICAgICAgICAgICAgZGF0YTogbnVsbCwKICAgICAgICAgICAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICAgICAgICAgICAgbGFuZzogewogICAgICAgICAgICAgICAgICAgIHZhbHVlOiAidGV4dCIsCiAgICAgICAgICAgICAgICAgICAgbGlzdDogW10KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB0aGVtZTogewogICAgICAgICAgICAgICAgICAgIHZhbHVlOiAiY2hyb21lIiwKICAgICAgICAgICAgICAgICAgICBsaXN0OiB0aGlzLm0zLkVESVRPUl9USEVNRQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIHdhdGNoOiB7CiAgICAgICAgJ21vZGVsLndvcmRzJzp7CiAgICAgICAgICAgIGhhbmRsZXIodmFsKXsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYoXy5pc0VtcHR5KHZhbCkpIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57CiAgICAgICAgICAgICAgICAgICAgbGV0IGtleXdvcmRzID0gbmV3IFJlZ0V4cCh2YWwuam9pbigifCIpLCJnIik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5lZGl0b3IuZWRpdG9yLmZpbmRBbGwoa2V5d29yZHMsewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlU2Vuc2l0aXZlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgd2hvbGVXb3JkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICByZWdFeHA6IHRydWUKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0sMTAwMCkKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgbW9kZWwoKXsKICAgICAgICAgICAgdGhpcy5pbml0KCk7CiAgICAgICAgfQogICAgfSwKICAgIGNvbXBvbmVudHM6ewogICAgICAgIEVkaXRvcjpyZXF1aXJlKCJ2dWUyLWFjZS1lZGl0b3IiKQogICAgfSwKICAgIG1vdW50ZWQoKXsKICAgICAgICB0aGlzLmluaXQoKTsKCiAgICAgICAgdGhpcy5ldmVudEh1Yi4kb24oIldJTkRPVy1SRVNJWkUtRVZFTlQiLCgpPT57CiAgICAgICAgICAgIHRoaXMuJHJlZnMuZWRpdG9yLmVkaXRvci5yZXNpemUoKTsKICAgICAgICB9KTsgCiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIG9uRWRpdG9ySW5pdCgpewogICAgICAgICAgICByZXF1aXJlKCdicmFjZS9leHQvc2VhcmNoYm94Jyk7CiAgICAgICAgICAgIHJlcXVpcmUoImJyYWNlL2V4dC9sYW5ndWFnZV90b29scyIpOyAvL2xhbmd1YWdlIGV4dGVuc2lvbiBwcmVyZXF1c2l0ZS4uLgogICAgICAgICAgICByZXF1aXJlKGBicmFjZS9tb2RlLyR7dGhpcy5lZGl0b3IubGFuZy52YWx1ZX1gKTsgLy9sYW5ndWFnZQogICAgICAgICAgICByZXF1aXJlKGBicmFjZS9zbmlwcGV0cy8ke3RoaXMuZWRpdG9yLmxhbmcudmFsdWV9YCk7IC8vc25pcHBldAogICAgICAgICAgICByZXF1aXJlKGBicmFjZS90aGVtZS8ke3RoaXMuZWRpdG9yLnRoZW1lLnZhbHVlfWApOyAvL2xhbmd1YWdlCiAgICAgICAgfSwKICAgICAgICBvblRvZ2dsZVRoZW1lKHZhbCl7CiAgICAgICAgICAgIHJlcXVpcmUoYGJyYWNlL3RoZW1lLyR7dmFsfWApOyAvL2xhbmd1YWdlCiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnRoZW1lLnZhbHVlID0gdmFsOwogICAgICAgIH0sCiAgICAgICAgaW5pdCgpewogICAgICAgICAgICB0aGlzLmVkaXRvci5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgbGV0IHBhcmFtID0gZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KCB0aGlzLm1vZGVsICkpOwoKICAgICAgICAgICAgdGhpcy5tMy5jYWxsRlMoIi9tYXRyaXgvbTNtY2Mvc2VhcmNoQml0bG9nQnlUZXJtLmpzIixwYXJhbSkudGhlbihydG49PnsKICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmRhdGEgPSB0aGlzLmFycmF5VG9Dc3YocnRuLm1lc3NhZ2UucmVzdWx0KTsKICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfSkuY2F0Y2goKCk9PnsKICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFycmF5VG9Dc3YoZGF0YSl7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGxldCBsaW5lQXJyYXkgPSBbXTsKICAgICAgICAgICAgXy5mb3JFYWNoKGRhdGEsIChpbmZvQXJyYXkpPT4gewogICAgICAgICAgICAgICAgbGV0IHZhbGlkID0gKG5ldyBEYXRlKGluZm9BcnJheVswXSkpLmdldFRpbWUoKSA+IDA7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmKHZhbGlkKXsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRzZXQoaW5mb0FycmF5LCAwLCB0aGlzLm1vbWVudChpbmZvQXJyYXlbMF0pLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcy5TU1MnKSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbGV0IGxpbmUgPSBpbmZvQXJyYXkuam9pbigiLCAiKTsKICAgICAgICAgICAgICAgIGxpbmVBcnJheS5wdXNoKGxpbmUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiBsaW5lQXJyYXkuam9pbigiXG4iKTsKICAgICAgICAgICAgCiAgICAgICAgfSwKICAgICAgICBhcnJheVRvSnNvbihkYXRhKXsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmR0LCdyb3dzJyxbXSk7CgogICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgKHYsIGluZGV4KT0+IHsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbGV0IHZhbGlkID0gKG5ldyBEYXRlKHZbMF0pKS5nZXRUaW1lKCkgPiAwOwogICAgICAgICAgICAgICAgbGV0IHRpbWUgPSAiIjsKCiAgICAgICAgICAgICAgICBpZih2YWxpZCl7CiAgICAgICAgICAgICAgICAgICAgdGltZSA9IHRoaXMubW9tZW50KHZbMF0pLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcy5TU1MnKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLmR0LnJvd3MucHVzaCgge2luZGV4OiBpbmRleCsxLCB0aW1lOiB0aW1lLCBtc2c6IHYuc2xpY2UoMykuam9pbigiLCAiKSwgZmlsZTp2WzFdLCBudW06dlsyXX0gKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgIH0sCiAgICAgICAgbWFya0J5VGVybShzdHIpewogICAgICAgICAgICBsZXQgZmluYWxTdHIgPSBzdHI7CiAgICAgICAgICAgIGxldCB0ZXJtID0gdGhpcy5vcHRpb25zLnRlcm0uc3BsaXQoIiwiKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIF8uZm9yRWFjaCh0ZXJtLCh2KT0+ewogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZihfLmlzRW1wdHkodikpIHJldHVybjsKCiAgICAgICAgICAgICAgICBsZXQgcmVnID0gbmV3IFJlZ0V4cCh2LCAnZ2ltJyk7CiAgICAgICAgICAgICAgICBmaW5hbFN0ciA9IGZpbmFsU3RyLnJlcGxhY2UocmVnLCBmdW5jdGlvbihzKXsgcmV0dXJuICc8bWFyayBzdHlsZT0icGFkZGluZzozcHg7Ij4nK3MrJzwvbWFyaz4nOyB9KTsKICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIHJldHVybiBmaW5hbFN0cjsKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["logView.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"logView.vue","sourceRoot":"src/components/search","sourcesContent":["<template>\n    <el-container style=\"height: calc(100% - 85px);\">\n        <el-header style=\"height:30px;line-height:30px;padding:0px;\">\n            <span style=\"font-weight: 900;\">{{model.id}} / {{model.field}} / {{model.file}}</span>\n            <el-dropdown style=\"padding-left:10px;float:right;\">\n                <span class=\"el-dropdown-link\">\n                    <svg-icon icon-class=\"theme\"/>\n                </span>\n                <el-dropdown-menu slot=\"dropdown\">\n                    <el-dropdown-item v-for=\"group in editor.theme.list\" :key=\"group.name\">\n                        <el-dropdown @command=\"onToggleTheme\">\n                            <span class=\"el-dropdown-link\">\n                            {{ group.name }}\n                            <i class=\"el-icon-arrow-down el-icon--right\"></i>\n                            </span>\n                            <el-dropdown-menu slot=\"dropdown\">\n                                <el-dropdown-item\n                                    v-for=\"item in group.items\"\n                                    :key=\"item.name\"\n                                    :command=\"item.name\">{{ item.name }}</el-dropdown-item>\n                                </el-dropdown-menu>\n                        </el-dropdown>\n                    </el-dropdown-item>\n                </el-dropdown-menu>\n            </el-dropdown>\n        </el-header>\n        <el-main :loading=\"editor.loading\" style=\"padding:0px;overflow:hidden;\">\n            <Editor\n                v-model=\"editor.data\"\n                @init=\"onEditorInit\"\n                :lang=\"editor.lang.value\"\n                :theme=\"editor.theme.value\"\n                width=\"99.8%\"\n                height=\"20vh\"\n                style=\"border:1px solid #f2f2f2;\"\n                ref=\"editor\"></Editor>\n        </el-main>\n    </el-container>\n</template>\n\n<script>\nimport _ from 'lodash';\n\nexport default{\n    props: {\n        model: Object\n    },\n    data(){\n        return {\n            dragging: false,\n            editor: {\n                data: null,\n                loading: false,\n                lang: {\n                    value: \"text\",\n                    list: []\n                },\n                theme: {\n                    value: \"chrome\",\n                    list: this.m3.EDITOR_THEME\n                }\n            }\n        }\n    },\n    watch: {\n        'model.words':{\n            handler(val){\n                \n                if(_.isEmpty(val)) return false;\n\n                setTimeout(()=>{\n                    let keywords = new RegExp(val.join(\"|\"),\"g\");\n                    this.$refs.editor.editor.findAll(keywords,{\n                        caseSensitive: false,\n                        wholeWord: true,\n                        regExp: true\n                    });\n                },1000)\n            }\n        },\n        model(){\n            this.init();\n        }\n    },\n    components:{\n        Editor:require(\"vue2-ace-editor\")\n    },\n    mounted(){\n        this.init();\n\n        this.eventHub.$on(\"WINDOW-RESIZE-EVENT\",()=>{\n            this.$refs.editor.editor.resize();\n        }); \n    },\n    methods: {\n        onEditorInit(){\n            require('brace/ext/searchbox');\n            require(\"brace/ext/language_tools\"); //language extension prerequsite...\n            require(`brace/mode/${this.editor.lang.value}`); //language\n            require(`brace/snippets/${this.editor.lang.value}`); //snippet\n            require(`brace/theme/${this.editor.theme.value}`); //language\n        },\n        onToggleTheme(val){\n            require(`brace/theme/${val}`); //language\n            this.editor.theme.value = val;\n        },\n        init(){\n            this.editor.loading = true;\n            let param = encodeURIComponent(JSON.stringify( this.model ));\n\n            this.m3.callFS(\"/matrix/m3mcc/searchBitlogByTerm.js\",param).then(rtn=>{\n                this.editor.data = this.arrayToCsv(rtn.message.result);\n                this.editor.loading = false;\n            }).catch(()=>{\n                this.editor.loading = false;\n            })\n        },\n        arrayToCsv(data){\n                    \n            let lineArray = [];\n            _.forEach(data, (infoArray)=> {\n                let valid = (new Date(infoArray[0])).getTime() > 0;\n                \n                if(valid){\n                    this.$set(infoArray, 0, this.moment(infoArray[0]).format('YYYY-MM-DD HH:mm:ss.SSS'));\n                }\n\n                let line = infoArray.join(\", \");\n                lineArray.push(line);\n            });\n            \n            return lineArray.join(\"\\n\");\n            \n        },\n        arrayToJson(data){\n            \n            this.$set(this.dt,'rows',[]);\n\n            _.forEach(data, (v, index)=> {\n                \n                let valid = (new Date(v[0])).getTime() > 0;\n                let time = \"\";\n\n                if(valid){\n                    time = this.moment(v[0]).format('YYYY-MM-DD HH:mm:ss.SSS');\n                }\n\n                this.dt.rows.push( {index: index+1, time: time, msg: v.slice(3).join(\", \"), file:v[1], num:v[2]} );\n            });\n            \n        },\n        markByTerm(str){\n            let finalStr = str;\n            let term = this.options.term.split(\",\");\n            \n            _.forEach(term,(v)=>{\n                \n                if(_.isEmpty(v)) return;\n\n                let reg = new RegExp(v, 'gim');\n                finalStr = finalStr.replace(reg, function(s){ return '<mark style=\"padding:3px;\">'+s+'</mark>'; });\n            })\n\n            return finalStr;\n        }\n    }\n}\n</script>\n\n<style>\n    /* .ace_editor .ace_marker-layer .ace_selection {\n        background: #fbde868a !important;\n    }\n    .ace_editor .ace_marker-layer .ace_active-line {\n        background: #fbde868a !important;\n    } */\n    /* ace find highlight */\n    .ace_editor .ace_marker-layer .ace_selected-word {\n        background: #fbde868a !important;\n        border: 1px solid /*[[base-color]]*/ #f3f5f8 !important;\n    }\n</style>\n"]}]}