{"remainingRequest":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/src/components/mcc/lineChart.vue?vue&type=style&index=0&id=78e90e68&scoped=true&lang=css&","dependencies":[{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/src/components/mcc/lineChart.vue","mtime":1630766748237},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3mcc/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmNvbnRhaW5lcnsKICAgIHBhZGRpbmc6IDIwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZjJmMmYyOwp9Cg=="},{"version":3,"sources":["lineChart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgJA;AACA;AACA;AACA","file":"lineChart.vue","sourceRoot":"src/components/mcc","sourcesContent":["<template>\n    <div>\n        <h5>{{model.id}}/{{model.bucket}}/{{model.key}}</h5>\n        <div style=\"width:100%;height:300px;\" ref=\"chartContainer\"></div>\n    </div>\n</template>\n\n<script>\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport echarts from 'echarts';\nexport default{\n    props:{\n        model:Object\n    },\n    data(){\n        return {\n            chart: null,\n            option: {\n                tooltip: {\n                    trigger: 'axis'\n                },\n                toolbox: {\n                    right: 10,\n                    top: 0,\n                    feature: {\n                        dataZoom: {\n                            yAxisIndex: 'none'\n                        },\n                        restore: {},\n                        saveAsImage: {}\n                    }\n                },\n                grid: {\n                    top: '15%',\n                    left: '3%',\n                    right: '4%',\n                    bottom: '35%',\n                    containLabel: true\n                },\n                xAxis: {\n                    type: 'category',\n                    data: []\n                },\n                yAxis: {\n                    type: 'value'\n                },\n                series: []\n            }                            \n        }\n    },\n    watch: {\n        model:{\n            handler(){\n                this.initData();\n            },\n            deep:true\n        }\n    },\n    created(){\n        \n        // 初始化数据\n        this.initData();\n\n        // 接收窗体RESIZE事件\n        this.eventHub.$on(\"WINDOW-RESIZE-EVENT\", this.checkChart);\n    },\n    mounted() {\n        this.$nextTick(()=>{\n            this.init();\n        })\n\n        // 监听窗口发生变化，resize组件\n        window.addEventListener('resize', this.checkChart)\n        \n        // 通过hook监听组件销毁钩子函数，并取消监听事件\n        this.$once('hook:beforeDestroy', () => {\n            window.removeEventListener('resize', this.checkChart)\n        })\n    },\n    methods: {\n        init(){\n            setTimeout(()=>{\n                this.chart = echarts.init(this.$refs.chartContainer);\n                this.chart.setOption(this.option);\n            },500)\n        },\n        initData(){\n            try{\n                let param = encodeURIComponent( JSON.stringify(this.model) );\n                this.m3.callFS(\"/matrix/m3mcc/searchPerformanceByTerm.js\",param).then( res=>{\n                    \n                    if(res.message.result.length < 1) return false;\n                    \n                    let rtn = res.message.result.reverse();\n\n                    //取实时数据的time作为xAxis\n                    this.option.xAxis.data = _.map(rtn,(v)=>{\n                        return this.moment(v[0]).format('YY-MM-DD HH:mm');\n                    });\n                    \n                    this.option.series = [{\n                        name: `${this.model.bucket} ${this.model.key}`,\n                        data: _.map(rtn,(v)=>{ return v[1];}),\n                        type: 'line',\n                        smooth:true,\n                        color: 'rgba(108, 212, 11, 1)',\n                        areaStyle: {\n                            normal: {\n                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n                                    offset: 0,\n                                    color: 'rgba(108, 212, 11, .5)'\n                                }, {\n                                    offset: 1,\n                                    color: 'rgba(108, 212, 11, .1)'\n                                }])\n                            }\n                        }\n                    }];\n\n                    if(this.$refs.chartContainer){\n                        this.chart.setOption(this.option);\n                    }\n                } );\n                \n            } catch(err){\n                console.error(err);\n            }\n        },\n        checkChart(){\n            try{\n                this.chart.resize();\n            } catch(err){\n                console.error(err)\n            }\n        },\n        destroyed(){\n            $(this.$el).off();\n        }\n    }    \n}\n</script>\n\n<style scoped>\n    .container{\n        padding: 20px;\n        background: #f2f2f2;\n    }\n</style>\n"]}]}